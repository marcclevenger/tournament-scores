<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCPL Flag Football Tracker</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for a cleaner look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f6f9;
        }
        input[type="number"] {
            -moz-appearance: textfield; /* Firefox */
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none; /* Chrome, Safari, Edge */
            margin: 0;
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-2 text-center">NCPL Flag Football Standings Tracker</h1>
        <p class="text-lg text-gray-500 mb-8 text-center">Enter the scores for the games below to generate live standings.</p>

        <!-- Standings Table -->
        <div class="bg-white p-6 rounded-xl shadow-2xl mb-12">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2 flex items-center justify-between">
                <span>LIVE STANDINGS</span>
                <span class="text-sm font-medium text-sky-600 bg-sky-100 px-3 py-1 rounded-full">Top 4 Advance</span>
            </h2>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-sky-50">
                        <tr>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Seed</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team</th>
                            <th class="px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">W-L</th>
                            <th class="px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">PF</th>
                            <th class="px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">PA</th>
                            <th class="px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Diff</th>
                        </tr>
                    </thead>
                    <tbody id="standings-body" class="bg-white divide-y divide-gray-200">
                        <!-- Standings Rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Schedule Input Table -->
        <div class="bg-white p-6 rounded-xl shadow-2xl">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Game Schedule (4 Games Each)</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time / Field</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team A</th>
                            <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Score A</th>
                            <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Score B</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team B</th>
                        </tr>
                    </thead>
                    <tbody id="schedule-body" class="bg-white divide-y divide-gray-200">
                        <!-- Schedule Rows with Input Fields will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <script>
        // Global variables and constants
        const TEAMS = [
            "Nativity", "Notre Dame", "St. John", "St. Mary", 
            "St. Michael's 8", "St. Michael's 7", "St. Patrick"
        ];

        // The full tournament schedule (verified and balanced)
        const SCHEDULE = [
            // 12:30 - 12:50
            { time: "12:30-12:50", field: 1, teamA: "Notre Dame", teamB: "St. Michael's 8" },
            { time: "12:30-12:50", field: 2, teamA: "St. Patrick", teamB: "St. Mary" },
            // 12:55 - 1:15
            { time: "12:55-1:15", field: 1, teamA: "St. Michael's 7", teamB: "St. John" },
            { time: "12:55-1:15", field: 2, teamA: "St. Patrick", teamB: "Notre Dame" },
            // 1:20 - 1:40
            { time: "1:20-1:40", field: 1, teamA: "St. Michael's 8", teamB: "St. Patrick" },
            { time: "1:20-1:40", field: 2, teamA: "St. Mary", teamB: "Nativity" },
            // 1:45 - 2:05
            { time: "1:45-2:05", field: 1, teamA: "Nativity", teamB: "St. John" },
            { time: "1:45-2:05", field: 2, teamA: "Notre Dame", teamB: "St. Mary" },
            // 2:10 - 2:30
            { time: "2:10-2:30", field: 1, teamA: "St. Michael's 7", teamB: "St. Mary" },
            { time: "2:10-2:30", field: 2, teamA: "St. Michael's 8", teamB: "Nativity" },
            // 2:35 - 2:55
            { time: "2:35-2:55", field: 1, teamA: "Nativity", teamB: "St. Michael's 7" },
            { time: "2:35-2:55", field: 2, teamA: "St. Michael's 8", teamB: "St. John" },
            // 3:00 - 3:10 (The crucial final game correction)
            { time: "3:00-3:10", field: 1, teamA: "Notre Dame", teamB: "St. Michael's 7" },
            { time: "3:00-3:10", field: 2, teamA: "St. Patrick", teamB: "St. John" }
        ];

        /**
         * Renders the game schedule table with input fields.
         */
        function renderSchedule() {
            const scheduleBody = document.getElementById('schedule-body');
            scheduleBody.innerHTML = ''; // Clear existing rows

            SCHEDULE.forEach((game, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 transition duration-100';
                
                // NOTE: Conditional styling removed to ensure all inputs are white
                
                row.innerHTML = `
                    <td class="px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900">
                        ${game.time} / <span class="font-mono text-xs text-sky-600">F${game.field}</span>
                    </td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-800 font-semibold">${game.teamA}</td>
                    <td class="px-1 py-2 text-center">
                        <input type="number" id="scoreA-${index}" value="" min="0" placeholder="0"
                            class="w-14 h-8 text-center text-sm font-bold border rounded-md focus:ring-sky-500 focus:border-sky-500 bg-white"
                            oninput="updateStandings()">
                    </td>
                    <td class="px-1 py-2 text-center">
                        <input type="number" id="scoreB-${index}" value="" min="0" placeholder="0"
                            class="w-14 h-8 text-center text-sm font-bold border rounded-md focus:ring-sky-500 focus:border-sky-500 bg-white"
                            oninput="updateStandings()">
                    </td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-800 font-semibold">${game.teamB}</td>
                `;
                scheduleBody.appendChild(row);
            });
        }

        /**
         * Calculates the total stats for all teams based on current scores.
         * @returns {Array<Object>} Array of team stats objects.
         */
        function calculateStats() {
            // Initialize stats for all teams
            const stats = {};
            TEAMS.forEach(team => {
                stats[team] = { team: team, W: 0, L: 0, PF: 0, PA: 0, Diff: 0 };
            });

            // Process all games
            SCHEDULE.forEach((game, index) => {
                const scoreAInput = document.getElementById(`scoreA-${index}`);
                const scoreBInput = document.getElementById(`scoreB-${index}`);

                // Safely parse scores (defaults to 0 if empty or invalid)
                const scoreA = parseInt(scoreAInput.value) || 0;
                const scoreB = parseInt(scoreBInput.value) || 0;
                
                // Only process games where scores have been entered
                if (scoreAInput.value === '' && scoreBInput.value === '') return;

                const teamAStats = stats[game.teamA];
                const teamBStats = stats[game.teamB];

                // 1. Update Points For (PF) and Points Against (PA)
                teamAStats.PF += scoreA;
                teamAStats.PA += scoreB;
                teamBStats.PF += scoreB;
                teamBStats.PA += scoreA;

                // 2. Update Wins (W) and Losses (L)
                if (scoreA > scoreB) {
                    teamAStats.W += 1;
                    teamBStats.L += 1;
                } else if (scoreB > scoreA) {
                    teamBStats.W += 1;
                    teamAStats.L += 1;
                }
                // Ties (scoreA === scoreB) do not increment W or L
            });

            // 3. Calculate Differential (PF - PA)
            TEAMS.forEach(team => {
                const teamStats = stats[team];
                teamStats.Diff = teamStats.PF - teamStats.PA;
            });

            // Convert object to array for sorting
            return Object.values(stats);
        }

        /**
         * Sorts and ranks the teams.
         * Primary sort: Wins (desc). Secondary sort: Differential (desc).
         * @param {Array<Object>} teams - Array of team stats objects.
         * @returns {Array<Object>} Sorted array of teams with calculated Rank/Seed.
         */
        function rankTeams(teams) {
            teams.sort((a, b) => {
                // 1. Primary sort: Wins (descending)
                if (b.W !== a.W) {
                    return b.W - a.W;
                }
                // 2. Secondary sort: Differential (descending)
                return b.Diff - a.Diff;
            });

            // Assign seed/rank
            teams.forEach((team, index) => {
                team.Seed = index + 1;
            });
            
            return teams;
        }

        /**
         * Updates the Standings table based on the calculated and ranked data.
         * @param {Array<Object>} rankedTeams - Sorted and ranked array of team stats.
         */
        function renderStandings(rankedTeams) {
            const standingsBody = document.getElementById('standings-body');
            standingsBody.innerHTML = ''; // Clear existing rows

            rankedTeams.forEach((team) => {
                const row = document.createElement('tr');
                
                // Apply a visual highlight for the top 4 advancing teams
                const isAdvancing = team.Seed <= 4;
                row.className = `transition duration-150 ${isAdvancing ? 'bg-sky-50 font-bold hover:bg-sky-100' : 'bg-white hover:bg-gray-50'}`;

                row.innerHTML = `
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-center ${isAdvancing ? 'text-sky-600 text-lg' : 'text-gray-500'}">${team.Seed}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-900">${team.team}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-center text-gray-800">${team.W}-${team.L}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-center text-gray-800">${team.PF}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-center text-gray-800">${team.PA}</td>
                    <td class="px-3 py-2 whitespace-nowrap text-sm text-center ${team.Diff > 0 ? 'text-green-600' : (team.Diff < 0 ? 'text-red-600' : 'text-gray-500')}">${team.Diff}</td>
                `;
                standingsBody.appendChild(row);
            });
        }

        /**
         * Main function to be called on every score input change.
         */
        function updateStandings() {
            const teamStats = calculateStats();
            const rankedTeams = rankTeams(teamStats);
            renderStandings(rankedTeams);
        }

        // Initialize the app on load
        window.onload = () => {
            renderSchedule();
            updateStandings(); // Initial calculation with 0s
        };
    </script>
</body>
</html>